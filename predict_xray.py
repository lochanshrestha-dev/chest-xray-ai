import os\nimport json\nimport torch\nimport torchvision.transforms as transforms\nfrom torchvision import models\nimport torchxrayvision as xrv\n\n# Define the path to the images\nimage_dir = os.path.expanduser('~/Desktop/CXR_AI_Project/Data/')\n\n# Load the model\nmodel = xrv.models.DenseNet(weights='densenet121-res224-all')\nmodel.eval()\n\n# Image transformation\ntransform = transforms.Compose([\n    transforms.Resize((224, 224)),\n    transforms.ToTensor(),\n])\n\n# Function to process images and make predictions\ndef predict_xray_images(image_dir):\n    predictions = {}\n    for filename in os.listdir(image_dir):\n        if filename.endswith('.png') or filename.endswith('.jpg'):  # Process PNG and JPG images\n            img_path = os.path.join(image_dir, filename)\n            img = xrv.utils.load_image(img_path)\n            img_tensor = transform(img).unsqueeze(0)\n            with torch.no_grad():\n                output = model(img_tensor)\n                preds = torch.sigmoid(output).numpy()\n                predictions[filename] = preds.tolist()\n    return predictions\n\nif __name__ == '__main__':\n    results = predict_xray_images(image_dir)\n    with open('predictions.json', 'w') as json_file:\n        json.dump(results, json_file)\n